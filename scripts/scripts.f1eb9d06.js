"use strict";angular.module("merchantApp",["ngRoute","ngMap"]).config(["$routeProvider","$httpProvider",function(a,b){b.defaults.useXDomain=!0,b.defaults.withCredentials=!0,a.when("/",{templateUrl:"views/user/login.html",controller:"UserCtrl"}).when("/user/feedback",{templateUrl:"views/user/feedback.html",controller:"UserCtrl"}).when("/user/home",{templateUrl:"views/user/home.html",controller:"UserCtrl"}).when("/user/about",{templateUrl:"views/user/about.html",controller:"UserCtrl"}).when("/user/login",{templateUrl:"views/user/login.html",controller:"UserCtrl"}).when("/user/register",{templateUrl:"views/user/register.html",controller:"UserCtrl"}).when("/user/profile",{templateUrl:"views/user/profile.html",controller:"UserCtrl"}).when("/user/password/retrieve",{templateUrl:"views/password/retrieve.html",controller:"UserCtrl"}).when("/user/password",{templateUrl:"views/user/password.html",controller:"UserCtrl"}).when("/user/dashboard",{templateUrl:"views/user/dashboard.html",controller:"UserCtrl"}).when("/merchandise/home",{templateUrl:"views/merchandise/home.html",controller:"MerchandiseCtrl"}).when("/merchandise/more",{templateUrl:"views/merchandise/more.html",controller:"MerchandiseCtrl"}).when("/merchandise/search",{templateUrl:"views/merchandise/search.html",controller:"MerchandiseCtrl"}).when("/merchandise/category/:id",{templateUrl:"views/merchandise/home.html",controller:"MerchandiseCtrl"}).when("/merchandise/add",{templateUrl:"views/merchandise/add.html",controller:"MerchandiseCtrl"}).when("/merchandise/edit/:id",{templateUrl:"views/merchandise/edit.html",controller:"MerchandiseCtrl"}).when("/merchandise/list/:page",{templateUrl:"views/merchandise/list.html",controller:"MerchandiseCtrl"}).when("/merchandise/:category/:ordering/:online/:action/:id/:page",{templateUrl:"views/merchandise/add.html",controller:"MerchandiseCtrl"}).when("/merchandise/:category/:ordering/:online/list/:page",{templateUrl:"views/merchandise/list.html",controller:"MerchandiseCtrl"}).when("/merchandise/:category/:ordering/:online/q/:query/:page",{templateUrl:"views/merchandise/query.html",controller:"MerchandiseCtrl"}).when("/merchandise/:category/:ordering/:online/q/:query/list/:page",{templateUrl:"views/merchandise/query.html",controller:"MerchandiseCtrl"}).when("/grocery/home",{templateUrl:"views/grocery/home.html",controller:"GroceryCtrl"}).when("/grocery/settings",{templateUrl:"views/grocery/settings.html",controller:"GroceryCtrl"}).when("/grocery/edit",{templateUrl:"views/grocery/edit.html",controller:"GroceryCtrl"}).when("/grocery/location",{templateUrl:"views/grocery/location.html",controller:"GroceryCtrl"}).when("/preview/home",{templateUrl:"views/preview/home.html",controller:"PreviewCtrl"}).when("/preview/profile",{templateUrl:"views/preview/home.html",controller:"PreviewCtrl"}).when("/preview/comments",{templateUrl:"views/preview/home.html",controller:"PreviewCtrl"}).when("/barcode/list/:page",{templateUrl:"views/barcode/list.html",controller:"BarcodeCtrl"}).when("/barcode/home",{templateUrl:"views/barcode/home.html",controller:"BarcodeCtrl"}).when("/pay/home",{templateUrl:"views/pay/home.html",controller:"PayCtrl"}).when("/payment/home",{templateUrl:"views/pay/home.html",controller:"PayCtrl"}).when("/order/home",{templateUrl:"views/order/home.html",controller:"OrderCtrl"}).when("/order/:state/list/:page",{templateUrl:"views/order/list.html",controller:"OrderCtrl"}).when("/order/query/:q/:page",{templateUrl:"views/order/list.html",controller:"OrderCtrl"}).when("/order/:state/query/:q/:page",{templateUrl:"views/order/list.html",controller:"OrderCtrl"}).when("/subscribed/list",{templateUrl:"views/subscribed/list.html",controller:"SubscribedCtrl"}).when("/subscribed/list/:page",{templateUrl:"views/subscribed/list.html",controller:"SubscribedCtrl"}).when("/search/home",{templateUrl:"views/search/home.html",controller:"SearchCtrl"}).when("/search/:type/:q/:page",{templateUrl:"views/search/type.html",controller:"SearchCtrl"}).when("/search/:type",{templateUrl:"views/search/type.html",controller:"SearchCtrl"}).when("/category/:parent/list/:id",{templateUrl:"views/category/list.html",controller:"CategoryCtrl"}).when("/category/list",{templateUrl:"views/category/list.html",controller:"CategoryCtrl"}).when("/category/list/:id",{templateUrl:"views/category/list.html",controller:"CategoryCtrl"}).when("/category/edit/:id",{templateUrl:"views/category/edit.html",controller:"CategoryCtrl"}).when("/category/add",{templateUrl:"views/category/add.html",controller:"CategoryCtrl"}).when("/category/search",{templateUrl:"views/category/search.html",controller:"CategoryCtrl"}).when("/category/home",{templateUrl:"views/category/home.html",controller:"CategoryCtrl"}).when("/pay",{templateUrl:"views/pay/main.html",controller:"PayCtrl"}).otherwise({redirectTo:"/user/login"})}]),angular.module("merchantApp").controller("UserCtrl",["$scope","$route","user","images","url","messages",function(a,b,c,d,e,f){switch(a.url=e,a.retrievePhone=!0,a.$on("$includeContentLoaded",function(){a.module="user"}),b.current.$$route.originalPath){case"/user/login":case"/user/logout":case"/user/password/retrieve":case"/user/register":break;default:c.profile(a)}a.register=c.register,a.login=c.login,a.logout=c.logout,a.retrieve=c.password.retrieve,a.updatePassword=c.password.update,a.modify=function(){c.update(a)},a.fileChanged=function(){d.preview($("input[type=file][name=avatar]")[0].files,function(a){$("img[name=image-logo]").attr("src",a)})},a.feedback=function(){var a=new FormData($("form")[0]);c.feedback(a)},a.getCaptcha=function(){return a.phone?validator.isMobilePhone(a.phone,"zh-CN")?($(".btn-get-sms-captcha").attr("disabled","disabled"),$(".btn-get-sms-captcha").html("正在发送..."),void f.captcha.phone({phone:a.phone},function(a){switch(a.name){case"Success":var b=60;$(".btn-register").removeAttr("disabled"),$(".btn-get-sms-captcha").html(b--+"秒后重新发送");var c=setInterval(function(){return 0>=b?($(".btn-get-sms-captcha").removeAttr("disabled"),$(".btn-get-sms-captcha").html("重新获取验证码"),void clearInterval(c)):void $(".btn-get-sms-captcha").html(b--+"秒后重新发送")},1e3)}})):void alert("手机号不正确"):void alert("请输入手机号！")},a.checked=!1,a.fetching=!1,a.captcha=!1;var g;$(".btn-get-sms-captcha").attr("disabled","disabled"),$(".btn-get-email-captcha").attr("disabled","disabled"),$(".btn-register").attr("disabled","disabled"),$("[name=captchaImage]").keydown(function(){g&&clearTimeout(g),g=setTimeout(function(){var b=$("[name=captchaImage]").val();f.captcha.check({captcha:b},function(b){switch(a.captcha=!0,b.name){case"Success":a.checked=!0,$(".btn-get-sms-captcha").removeAttr("disabled"),$(".btn-get-email-captcha").removeAttr("disabled");break;default:a.checked=!1}})},1e3)}),a.updateImage=function(){var a=$("#image-captcha > span"),b=e+"captcha/image?t="+new Date;a.html('<img src="'+b+'"/>')},a.phoneRegister=function(){c.captcha($("[name=captchaSms]").val())}}]),angular.module("merchantApp").controller("SearchCtrl",["$scope","$route","$document","$location","merchandise","category","order",function(a,b,c,d,e,f,g){function h(b,c){switch(j){case"category":a.type="分类",b&&(a.searching=!0,f.inputSearch(b,c,function(b){a.searching=!1,b&&(a.categories=b.results,a.total=b.total,a.page=b.page)}));break;case"merchandise":a.type="商品",b&&(a.searching=!0,e.inputSearch(b,c,function(b){a.searching=!1,b&&(a.merchandises=b.results,a.total=b.total,a.page=b.page)}));break;case"order":a.type="订单",b&&(a.searching=!0,g.query({no:b,page:c},function(b,c){a.searching=!1,console.log(c),c&&(a.orders=c.results,a.total=c.total,a.page=c.page)}))}}a.$on("$includeContentLoaded",function(){a.module="grocery"});var i=parseInt(b.current.params.page)||0,j=b.current.params.type,k=decodeURIComponent(b.current.params.q||"");a.q=k,a.searching=!1,h(),a.search=function(){var a=encodeURIComponent(c.find("#q").val());console.log(a);var b="/search/"+j+"/"+a+"/1";d.path(b)},a.showItem=function(a){console.log(a),c.find("#list-"+a).show(),c.find("#list-"+a).removeClass("hidden"),c.find("#hide-item-"+a).show(),c.find("#hide-item-"+a).removeClass("hidden"),c.find("#show-item-"+a).hide()},a.hideItem=function(a){console.log(a),c.find("#list-"+a).hide(),c.find("#hide-item-"+a).hide(),c.find("#show-item-"+a).show()},a.onChange=function(){console.log("start new timer");var a=c.find("#q").val();a&&h(a,i)},a.online=function(a){switch(j){case"category":f.online(a);break;case"merchandise":e.online(a)}},a.offline=function(a){switch(j){case"category":f.offline(a);break;case"merchandise":e.offline(a)}},a.remove=function(a){if(confirm("确定要删除吗?操作不可恢复!"))switch(j){case"category":f.remove(a,function(){b.reload()});break;case"merchandise":e.offline(a,function(){b.reload()})}},a.showTransState=function(a,b){return g.changeable(a.state,b,a.delivery,a.payment)},a.showState=function(a,b){return a.state===b},a.showDetail=function(a){console.log("showDetail");var b="#order-detail-"+a.no,c="#order-detail-show-"+a.no,d="#order-detail-hide-"+a.no;$(b).removeClass("hidden"),$(c).addClass("hidden"),$(d).removeClass("hidden")},a.hideDetail=function(a){console.log("hideDetail");var b="#order-detail-"+a.no,c="#order-detail-show-"+a.no,d="#order-detail-hide-"+a.no;$(b).addClass("hidden"),$(c).removeClass("hidden"),$(d).addClass("hidden")}}]),angular.module("merchantApp").service("api",["url","$http","$location",function(a,b,c){function d(b){return a+f+b}function e(a,e,h,i,j,k){var l;f=j?j:"grocery/",l=e?e instanceof FormData?b.post(d(a),e,{withCredentials:!0,headers:{"Content-Type":void 0}}):b.post(d(a),e):b.post(d(a)),h=h||g,l.success(function(a){if(k)return i(a);if("name"in a)switch(a.name){case"Success":i(a);break;case"NotLoggedIn":case"MerchantNotLoggedIn":case"UserNotLoggedIn":c.path(h);break;default:a.data?i(a):alert(a.message)}}).error(function(){if("user/profile"===a)c.path(h);else{var b="请求错误，请检测网络。";alert(b)}})}var f,g="user/login";return{send:function(a,b,c){e(a,b,null,c)},upload:function(a,e,f){b.post(d(a),e,{withCredentials:!0,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if("code"in a)if("code"in a&&!a.code)f(a);else switch(a.name){case"UserNotLogin":c.path(g);break;default:alert(a.message)}else;}).error(function(){c.path(g)})},success:function(a,b,c,d){e(a,b,null,function(a){return d?c(a):void("Success"===a.name&&c(a))})},selfSend:function(a,b,c,d,f){e(a,b,null,function(a){return d?void("Success"===a.name&&c(a)):c(a)},f,!0)}}}]);var url="https://api.t1bao.com/";window.localStorage&&window.localStorage.getItem("url")&&(url=window.localStorage.getItem("url")),angular.module("merchantApp").constant("url",url),angular.module("merchantApp").service("messages",["api",function(a){return{user:{login:function(b,c){a.success("user/login",b,c)},logout:function(b){a.success("user/logout",{},b)},profile:function(b,c){c?a.selfSend("user/profile",{},b):a.success("user/profile",{},b)},register:function(b,c){a.send("user/register",b,c)},update:function(b,c){a.success("user/update",b,c)},feedback:function(b,c){a.success("user/feedback",b,c)},subscribed:function(b,c){a.success("user/subscribed",b,c)}},location:{update:function(b,c){a.success("location/update",b,c)}},grocery:{list:function(b,c){a.success("store/list",b,c)},nearby:function(b,c){a.success("store/nearby",b,c)},search:function(b,c){a.success("store/search",b,c)},info:function(b,c){a.success("store/info",b,c)},subscribe:function(b,c){a.success("store/subscribe",b,c)},unsubscribe:function(b,c){a.success("store/unsubscribe",b,c)},issubscribed:function(b,c){a.selfSend("store/issubscribed",b,c)}},merchandise:{list:function(b,c){a.success("merchandise/list",b,c)},info:function(b,c){a.success("merchandise/info",b,c)}},order:{create:function(b,c){a.success("order/create",b,c)},list:function(b,c){a.success("order/list",b,c)},info:function(b,c){a.success("order/info",b,c)},update:function(b,c){a.success("order/update",b,c)}},pay:{alipay:function(b,c){a.text("pay/alipay",b,c)}},address:{add:function(b,c){a.success("address/add",b,c)},list:function(b,c){a.success("address/list",b,c)},update:function(b,c){a.success("address/update",b,c)},remove:function(b,c){a.success("address/remove",b,c)}},category:{list:function(b,c){a.success("category/list",b,c)},merchandise:function(b,c){a.success("category/merchandise/list",b,c)}},captcha:{check:function(b,c){a.selfSend("captcha/check",b,c)},phone:function(b,c){a.selfSend("captcha/phone",b,c)},email:function(b,c){a.selfSend("captcha/email",b,c)},register:function(b,c){a.selfSend("captcha/register",b,c)}},password:{retrieve:function(b,c){a.selfSend("password/retrieve",b,c)}},oauth:{enc:function(b){a.selfSend("oauth/enc",{},b)}}}}]),angular.module("merchantApp").service("modal",["$timeout",function(a){return{alert:function(b,c){$("#modal-alert").modal("show"),$(".modal-body",$("#modal-alert")).html(b),$(".ok",$("#modal-alert")).unbind(),$(".ok",$("#modal-alert")).click(function(){$("#modal-alert").modal("hide"),a(function(){c&&c()},1e3)})},confirm:function(b,c,d){$("#modal-confirm").modal("show"),$(".modal-body",$("#modal-confirm")).html(b),$(".ok",$("#modal-confirm")).unbind(),$(".cancel",$("#modal-confirm")).unbind(),$(".ok",$("#modal-confirm")).click(function(){$("#modal-confirm").modal("hide"),a(function(){c&&c()},1e3)}),$(".cancel",$("#modal-confirm")).click(function(){$("#modal-confirm").modal("hide"),a(function(){d&&d()},1e3)})},startProgress:function(a){$("#modal-progress").modal("show"),$(".note",$("#modal-progress")).html(a)},stopProgress:function(){$("#modal-progress").modal("hide")}}}]),angular.module("merchantApp").controller("GroceryCtrl",["$scope","$route","$location","api","user","grocery","weixin",function(a,b,c,d,e,f,g){var h,i=!1;switch(a.module="grocery",b.current.$$route.originalPath){case"/grocery/edit":case"/grocery/home":case"/grocery/settings":a.type="profile",f.profile(function(b){b&&(a.grocery=b)});break;case"/grocery/location":a.type="location",a.notLoaded=f.notLoaded,f.getMap(function(b){a.notLoaded=!1,f.notLoaded=!1,f.onMap(b,function(a){var b=a.lat(),c=a.lng();$(".latitude").html(b),$(".longitude").html(c),h=a,i=!0}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var c=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);b.panTo(c),i||(i=!0,b.setZoom(15))},function(a){console.error("error occur"),console.error(a)})})}a.saveLocation=function(){if(h){var a={};a.latitude=h.lat(),a.longitude=h.lng(),a.altitude=1,a.accuracy=80,a.heading=3,a.speed=0,console.log(a),f.locationUpdate(a)}else alert("尚未指定坐标！")},a.modify=function(){var a=new FormData($("form.modify")[0]);console.log(a),f.update(a,function(a){a?(alert("更新成功!"),c.path("grocery/home")):alert("更新失败!")})},a.disableDelivery=function(){for(var b=["delivery_fee","delivery_limit","delivery_distance"],c=0;c<b.length;c++)a.grocery[b[c]]=0},a.verfiy=function(){f.request(function(){alert("请求成功!")})},a.click=function(b){switch(b){case"orders":c.path("order/state/created/1");break;case"position":c.path("grocery/location");break;case"category":c.path("category/home");break;case"payment":c.path("payment/home");break;case"settings":c.path("grocery/settings");break;case"barcode":c.path("barcode/home");break;case"merchandise":c.path("merchandise/home");break;case"feedback":c.path("user/feedback");break;case"search":c.path("search/home");break;case"preview":c.path("preview/home");break;case"share":if(a.grocery&&a.grocery.id){var d="http://grocery.t1bao.com/?id="+a.grocery.id,e={title:a.grocery.name,link:d,imgUrl:a.grocery.logo,desc:a.grocery.intro};g.share("weixin",e)}break;default:alert("功能尚未开通,敬请期待!")}},a.scan=function(){g.scan(function(a){alert("扫描成功!"+a)})},a.refresh=function(){$window.location.reload()},a.online=function(){a.grocery.online=!0,f.online(function(){})},a.offline=function(){a.grocery.online=!1,f.offline(function(){})}}]),angular.module("merchantApp").controller("NavCtrl",["$scope","$location","api","user",function(a,b,c,d){c.send("user/profile",null,function(b){b&&"code"in b&&"Success"===b.name&&(console.log(b),a.user=b.data,d.set(b.data))}),a.exit=function(){c.send("user/logout",null,function(a){a&&"code"in a&&"Success"===a.name&&b.path("user/login")})}}]),angular.module("merchantApp").service("user",["$location","api",function(a,b){var c,d={set:function(a){c=a},get:function(){return c},profile:function(a){b.send("user/profile",{},function(b){"Success"===b.name&&(a.user=b.data)})},update:function(a){var c=new FormData($("form.modify")[0]);b.send("user/update",c,function(c){console.log(c),"Success"===c.name&&(alert("更新成功!"),b.send("user/profile",{},function(b){"Success"===b.name&&(a.user=b.data)}))})},login:function(){var c=new FormData($("form")[0]);b.send("user/login",c,function(b){"Success"===b.name&&a.path("user/home")})},logout:function(){b.send("user/logout",{},function(){a.path("user/login")})},feedback:function(c){b.send("user/feedback",c,function(b){"Success"===b.name?(alert("反馈成功!"),a.path("user/home")):alert("反馈失败! 原因："+b.message)})},register:function(c){var d=new FormData;d.append("username",c),d.append("password",c),d.append("confirm",c),d.append("phone",c),b.send("user/register",d,function(b){console.log(b),"Success"===b.name&&(alert("注册成功!"),a.path("user/login"))})},captcha:function(c){var d=new FormData;d.append("captcha",c),b.send("merchant/captcha",d,function(b){console.log(b),"Success"===b.name&&(alert("注册成功!"),a.path("user/login"))})},password:{retrieve:function(){var c=new FormData($("form")[0]);b.send("password/retrieve",c,function(b){console.log(b),"Success"===b.name&&(alert("密码重置成功!"),a.path("user/login"))})},update:function(){var a=new FormData($("form.password")[0]);b.send("password/update",a,function(a){console.log(a),"Success"===a.name?(alert("密码修改成功，请用新密码重新登录！"),d.logout()):alert("密码修改失败，原因："+a.data.reason)})}}};return d}]),angular.module("merchantApp").controller("MerchandiseCtrl",["$scope","$route","$location","api","storage","merchandise","weixin",function(a,b,c,d,e,f,g){function h(){return console.log(p),"merchandise/"+p+"/"+r+"/"+q}function i(b){switch(b){case"online":a.onlineString="上线";break;case"offline":a.onlineString="下线";break;case"all":default:a.onlineString="全部"}}function j(a){var b={page:a,category:0};switch(isNaN(p)||(b.category=p),r&&(b.order=r),q){case"online":b.online=!0;break;case"offline":b.online=!1}return b}function k(b){var c=j(b);f.list(c,function(b){b&&(a.merchandises=b.results,e.set("merchandises",b.results),a.total=b.total,a.page=b.page)})}function l(b,c){var d=j(c);d.q=b,console.log(d),f.query(d,function(b){b&&(a.merchandises=b.results,e.set("merchandises",b.results),a.total=b.total,a.page=b.page)})}function m(b,c){"undefined"!==b&&b?(a.q=b,l(b,o,c)):k(o,c)}var n="merchandise";a.type="merchandise";var o=parseInt(b.current.params.page)||0,p=parseInt(b.current.params.category),q=b.current.params.online,r=b.current.params.ordering,s=null;try{s=parseInt(b.current.params.id)}catch(t){s=0}var u=b.current.params.query;switch(a.page=o,a.total=0,a.base=h(),a.onlineString="全部",a.order=r,a.q=u,u&&(a.base=h()+"/q/"+encodeURIComponent(u)),console.log(b.current.$$route.originalPath),b.current.$$route.originalPath){case"/merchandise/more":a.type="more";break;case"/merchandise/home":case"/merchandise/search":break;case"/merchandise/category/:id":p=parseInt(b.current.params.id);break;case"/merchandise/add":break;case"/merchandise/edit/:id":var v=e.get("merchandises");if(console.log(v),!v)return p=0,void c.path(h()+"/list/1");for(var w=!1,x=0;x<v.length;x++)if(s===v[x].id){var y=v[x],z=y.merchandise;z.sis=y.sis,z.images=y.images,z.price=y.price,a.merchandise=z,console.log(a.merchandise),w=!0;break}if(!w)return p=0,void c.path(h()+"/list/1");break;default:if(isNaN(p))return p=0,void c.path(h()+"/list/"+o)}a.$on("$includeContentLoaded",function(){a.module=n;var b=j(o);b.page=o+1,f.initScroll(".merchandise-list",function(){},function(b){b&&b.results.length&&(a.merchandises=a.merchandises.concat(b.results),e.set("merchandises",a.merchandises),a.total=b.total,a.page=b.page)},b)}),(!o||1>o)&&(o=1),i(q),console.log(q),u=decodeURIComponent(u);var A=[{name:"全部",value:"all"},{name:"价格",value:"price"},{name:"销量",value:"sells"},{name:"访问",value:"visits"}];for(a.orders=A,x=0;x<A.length;x++){var B=A[x];if(B.value===r){a.orderName=B.name;break}}d.send("category/list",{},function(b){if("Success"===b.name){a.categories=b.data.results;for(var c=0;c<a.categories.length;c++)p===a.categories[c].id&&(a.categoryName=a.categories[c].name);console.log(a.categories)}}),m(u),a.openAdd=function(){$(".add")[0].reset()},a.add=function(){var a=new FormData($("form.add")[0]);d.send("merchandise/add",a,function(a){switch(a.name){case"Success":switch($("#add").hide(),alert("添加成功！"),b.current.$$route.originalPath){case"/merchandise/add":return void c.path(h()+"/list/"+o)}k(o)}})},a.remove=function(a){confirm("确定要删除吗?操作不可恢复!")&&d.send("merchandise/remove",{id:a.merchandise.id},function(a){switch(a.name){case"Success":$("#add").hide(),alert("删除成功！"),k(o)}})},a.modify=function(){var a=new FormData($("form.modify")[0]);console.log(a),d.send("merchandise/update",a,function(a){console.log(a),"Success"===a.name&&(alert("更新成功!"),c.path("merchandise/home"),k(o))})},a.removeImage=function(a,b){console.log(a),console.log(b),confirm("确定要删除吗?操作不可恢复!")&&d.send("merchandise/image/remove",{mid:a,id:b},function(a){console.log(a),"Success"===a.name&&$(".merchandise-edit-image-"+b).remove()})},a.search=function(){console.log("search"),console.log("q = "+a.q),a.q?f.inputSearch(a.q,o,function(b){b&&(a.queries=b.results,a.total=b.total,a.page=b.page)}):(a.queries=[],a.total=0,a.page=0)},a.online=function(a){d.send("merchandise/online",{id:a.merchandise.id,online:!0},function(a){console.log(a),"Success"===a.name&&m(u,o)})},a.offline=function(a){d.send("merchandise/online",{id:a.merchandise.id,online:!1},function(a){console.log(a),"Success"===a.name&&m(u,o)})},a.selectCategory=function(b){console.log(b),b&&b.id?(a.category=b,p=b.id):(a.category=null,p=0),console.log(h()+"/list/"+o),c.path(h()+"/list/"+o)},a.back=function(){c.path(h()+"/list/"+o)},a.selectOrder=function(b){switch(a.order=b,b.value){case"sells":case"price":case"visits":r=b.value;break;default:r="none"}c.path(h()+"/list/"+o)},a.selectOnline=function(a){q=a,i(a),c.path(h()+"/list/"+o)},a.pageStep=function(a){a?o++:o>1&&o--,c.path(h()+"/list/"+o)},a.showItem=function(a){console.log(a),$("#list-"+a).show(),$("#list-"+a).removeClass("hidden"),$("#hide-item-"+a).show(),$("#hide-item-"+a).removeClass("hidden"),$("#show-item-"+a).hide()},a.hideItem=function(a){console.log(a),$("#list-"+a).hide(),$("#hide-item-"+a).hide(),$("#show-item-"+a).show()},a.scan=function(){g.scan()}}]),angular.module("merchantApp").controller("LocationCtrl",["$scope","modal","api","map",function(a,b,c,d){function e(a){d.update(a)}a.$on("$includeContentLoaded",function(){a.module="location",d.setCallback(e),d.init(),c.send("location/info",{},function(c){if(console.log(c),"Success"===c.name){var e=c.data;a.latitude=e.latitude,a.longitude=e.longitude,console.log(e),d.update(e)}else b.alert(c.message,function(){})}),a.save=function(){if(!a.latitude)return void b.alert("经度没有指定!",function(){});if(!a.longitude)return void b.alert("纬度没有指定!",function(){});var d={};d.latitude=a.latitude,d.longitude=a.longitude,d.altitude=1,d.accuracy=80,d.heading=3,d.speed=0,c.send("location/update",d,function(a){console.log(a),"Success"===a.name?b.alert("位置更新成功！",function(){}):b.alert(a.message,function(){})})}})}]),angular.module("merchantApp").controller("BarcodeCtrl",["$route","$scope","api","barcode",function(a,b,c,d){function e(a){c.send("merchandise/list",{page:a},function(a){"Success"===a.name&&(b.merchandises=a.data.results,b.total=a.data.total,b.page=a.data.page)})}function f(a){d.list(a,function(a){a&&(b.barcodes=a.results,b.page=a.page,b.total=a.total)})}function g(){var a,d=1;b.openBind=function(b){d=1,a=b,console.log(b),e(d)},b.prev=function(){d>1&&d--,e(d)},b.next=function(){d++,e(d)},b.onSelectItem=function(a){b.merchandise=a.merchandise,b.merchandise.sis=a.sis,b.merchandise.images=a.images,console.log(a.merchandise)},b.bind=function(){console.log(a),c.send("barcode/bind",{barcode:a.barcode.id,merchandise:b.merchandise.id},function(a){switch(a.code){case"Success":$("#bindMerchandise").hide(),f(i)}})},b.unbind=function(a){c.send("barcode/unbind",{barcode:a.barcode.id},function(a){switch(a.code){case"Success":$("#bindMerchandise").hide(),f(i)}})}}var h="merchandise";b.type="barcode",b.page=0,b.total=0,b.base="barcode";var i=parseInt(a.current.params.page);b.$on("$includeContentLoaded",function(){b.module=h,console.log("inside barcode list"),d.initScroll(".barcode-list",function(){},function(a){a&&(b.barcodes=b.barcodes.concat(a.results),b.page=a.page,b.total=a.total)},2)}),f(i),b.openQuery=function(){b.queried=!1},b.query=function(){console.log("query"),b.queried=!1;var a=new FormData($("form.query")[0]);c.send("barcode/query",a,function(a){switch(console.log(a),b.queried=!0,a.name){case"NotFound":console.log("not found"),b.merchandise=a.data.merchandise;break;case"Success":console.log(a.data.merchandise),b.found=!0,b.merchandise=a.data.merchandise}f(i)})},b.remove=function(a){confirm("确定要删除吗?操作不可恢复!")&&c.send("barcode/remove",{id:a.id},function(b){switch(console.log(b),b.code){case"Success":$("barcode-remove-"+a.id).remove(),f(i)}})},g()}]),angular.module("merchantApp").filter("currency",function(){return function(a){return a=parseFloat(a).toFixed(2),isNaN(a)&&(a=0),parseFloat(a).toFixed(2)}}),angular.module("merchantApp").controller("OrderCtrl",["$scope","$route","$location","api","order",function(a,b,c,d,e){function f(b,c){return b?void console.error(c):(a.progressing=!1,a.orders=c.results,a.page=c.page,a.total=c.total,a.count=c.count,void(a.base="order"))}function g(b,c){a.progressing=!0,a.orders=null,e.list(f,b,o,c)}function h(a,b){e.query({no:a,page:b},f)}function i(a,b){var c={page:b,q:a};o&&(c[o]=!0),e.query(c,f)}function j(c,d){switch(d){case"CANCELLED":if(!confirm("你确定要取消订单吗？"))return}e.state({id:c,state:d},function(c,d){if(console.log(c,d),c)return alert(c),void b.reload();for(var e=0;e<a.orders.length;e++)if(d.id===a.orders[e].id){a.orders[e]=d;break}b.reload()})}var k=e.getStates();console.log(k);var l=e.getDays();a.states=k,a.days=l;var m=b.current.params||{},n=parseInt(m.page);(!n||1>n)&&(n=1);var o=m.state,p=m.q,q={page:n};switch(o){case"created":a.title="已创建订单";break;case"accepted":a.title="待处理订单";break;case"delivered":a.title="已发货订单";break;case"received":a.title="已创建订单";break;case"cancelled":a.title="已取消订单";break;case"commented":a.title="已评论订单";break;case"finished":a.title="已完成订单";break;default:a.title="全部订单"}"all"===o&&(o=null),o&&(q[o]=!0);for(var r=0;r<k.length;r++)k[r].value===o&&(a.stateName=k[r].name);switch(a.$on("$includeContentLoaded",function(){a.module="order",e.initScroll(".order-list",function(){},function(b,c){return b?void console.error(c):void(c.results.length&&(a.orders=a.orders.concat(c.results),a.page=c.page,a.total=c.total,a.count=c.count,a.base="order"))},n,o,l)}),b.current.$$route.originalPath){case"/order/home":a.type="accepted",o="CREATED|PAID",g(n);break;case"/order/more":a.type="more";break;case"/order/state/:state/:page":a.type=b.current.params.state,o="accepted"===a.type?"CREATED|PAID":a.type.toUpperCase(),"delivered"!==a.type&&"finished"!==a.type,g(n);break;case"/order/list/:page":case"/order/:state/list/:page":g(n);break;case"/order/no/:q":case"/order/no/:q/:page":console.log("inside no"),h(p,n);break;case"/order/query/:q/:page":case"/order/:state/query/:q/:page":i(p,n)}a.cancel=function(a){d.send("order/cancel",{id:a.id},function(a){switch(console.log(a),a.name){case"Success":console.log(a),g(n)}})},a.query=function(){var b=a.q||$("#q").val();console.log(b),b&&(o?c.path("order/"+o+"/query/"+b+"/"+n):c.path("order/query/"+b+"/"+n))},a.no=function(){var b=a.q||$("#q").val();console.log("inside no"),console.log(b),b&&c.path("order/query/"+b+"/"+n)},a.back=function(){c.path("order/list/"+n)},a.selectState=function(a){a?c.path("order/"+a.value+"/list/1"):c.path("order/list/1")},a.selectDays=function(b){b?(a.dayName=b.name,g(n,b.value)):(a.dayName=null,g(n))},a.state=j,a.showTransState=function(a,b){return e.changeable(a.state,b,a.delivery,a.payment)},a.showState=function(a,b){return a.state===b},a.showDetail=function(a){console.log("showDetail");var b="#order-detail-"+a.no,c="#order-detail-show-"+a.no,d="#order-detail-hide-"+a.no;$(b).removeClass("hidden"),$(c).addClass("hidden"),$(d).removeClass("hidden")},a.hideDetail=function(a){console.log("hideDetail");var b="#order-detail-"+a.no,c="#order-detail-show-"+a.no,d="#order-detail-hide-"+a.no;$(b).addClass("hidden"),$(c).removeClass("hidden"),$(d).addClass("hidden")},a.pageUp=function(){n>0?(n--,g(n)):a.upMost=!0},a.pageDown=function(){a.upMost=!1,n++,g(n)}}]),angular.module("merchantApp").controller("SubscribedCtrl",["$scope","$route","api",function(a,b,c){a.$on("$includeContentLoaded",function(){a.module="subscribed",a.total=0,a.page=0,c.send("user/profile",null,function(b){b&&"code"in b&&"Success"===b.name&&(console.log(b),a.user=b.data)})});var d=parseInt(b.current.params.page);(!d||1>d)&&(d=1),c.send("subscribed/list",{page:d},function(b){switch(console.log(b),b.name){case"Success":a.subscibed=b.data.results,a.total=b.data.total,a.count=b.data.count,a.page=b.data.page}})}]),angular.module("merchantApp").controller("CategoryCtrl",["$scope","$route","$location","api","storage","category",function(a,b,c,d,e,f){function g(b){f.list(b,function(b){a.categories=b.results,e.set("categories",a.categories),a.total=b.total,a.page=b.page})}a.type="category";var h=parseInt(b.current.params.page);switch((!h||1>h)&&(h=1),a.$on("$includeContentLoaded",function(){a.module="merchandise",f.initScroll(".category-list",function(){},function(b){b&&(a.categories=a.categories.concat(b.results),e.set("categories",a.categories),a.total=b.total,a.page=b.page)},h+1)}),b.current.$$route.originalPath){case"/category/home":g(h);break;case"/category/edit/:id":var i=null;try{i=parseInt(b.current.params.id)}catch(j){c.path("/category/0/list/"+h)}var k=e.get("categories");if(console.log(k),!k)return void c.path("/category/0/list/"+h);for(var l=!1,m=0;m<k.length;m++)if(i===k[m].id){a.category=k[m],console.log(a.category),l=!0;break}break;case"/category/add/":return;default:g(h)}a.openAdd=function(){$(".subcategory.add")[0].reset()},a.add=function(){var a=new FormData($("form.add")[0]);console.log(a),f.add(a)},a.openModify=function(b){a.category=b},a.remove=function(a){confirm("操作不可恢复，你确定要删除吗？")&&d.send("category/remove",{id:a.id},function(a){console.log(a),"Success"===a.name&&g(h)})},a.update=function(){var a=new FormData($("form.update")[0]);f.update(a)},a.search=function(){console.log("search"),console.log("q = "+a.q),a.q?f.inputSearch(a.q,h,function(b){b&&(a.queries=b.results,a.total=b.total,a.page=b.page)}):(a.queries=[],a.total=0,a.page=0)},a.online=function(a){d.send("category/online",{id:a.id,online:!0},function(b){console.log(b),"Success"===b.name&&(a.online=!0)})},a.offline=function(a){d.send("category/online",{id:a.id,online:!1},function(b){console.log(b),"Success"===b.name&&(a.online=!1)})}}]),angular.module("merchantApp").filter("date",function(){return function(a){var b=new Date(a);return moment(b).format("YYYY-MM-DD hh:mm:ss")}}),angular.module("merchantApp").service("storage",function(){var a={};return{set:function(b,c){a[b]=c,window.localStorage&&window.localStorage.setItem(b,JSON.stringify(c))},get:function(b){if(a[b])return a[b];if(window.localStorage){var c=window.localStorage.getItem(b);return c=JSON.parse(c)}}}}),angular.module("merchantApp").controller("PayCtrl",["$scope",function(a){a.module="grocery",a.$on("$includeContentLoaded",function(){a.module="grocery"})}]),angular.module("merchantApp").controller("NewCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("merchantApp").service("order",["api","scroll",function(a,b){var c=[{name:"新订单",value:"CREATED"},{name:"已经付款",
value:"PAID"},{name:"已经接受",value:"ACCEPTED"},{name:"已经发货",value:"DELIVERED"},{name:"已经签收",value:"RECEIVED"},{name:"已经评价",value:"COMMENTED"},{name:"已取消",value:"CANCELLED"},{name:"已经完成",value:"FINISHED"}],d=[{name:"今天",value:1},{name:"一星期内",value:7},{name:"10天内",value:10},{name:"30天内",value:30},{name:"3个月内",value:90},{name:"6个月内",value:180},{name:"1年内",value:365}];return{getStates:function(){return c},getDays:function(){return d},initScroll:function(a,c,d,e,f,g){var h=!1,i=this;console.log("sindie scroll"),console.log(a),b.bottom(a,function(){h||(c(),e++,i.list(d,e,f,g))})},list:function(b,c,d,e){var f={page:c};d&&(f.state=d),e&&!isNaN(e)&&(f.days=e),console.log(f),a.send("order/list",f,function(a){switch(console.log(a),a.name){case"Success":b(!1,a.data);break;default:b(!0)}})},query:function(b,c){b.no&&(b.q=b.no,delete b.no),a.send("order/query",b,function(a){switch(a.name){case"Success":c(!1,a.data);break;default:c(!0)}})},state:function(b,c){a.send("order/state",b,function(a){switch(console.log(a),a.name){case"Success":c(!1,a.data);break;default:c(!0)}})},changeable:function(a,b,c,d){var e={CREATED:["PAID","CANCELLED"],PAID:["ACCEPTED","CANCELLED"],ACCEPTED:["RECEIVED","CANCELLED"],DELIVERED:["RECEIVED","CANCELLED"],RECEIVED:["COMMENTED","FINISHED"],COMMENTED:["FINISHED"]};return"self"===c?e.ACCEPTED=["RECEIVED","CANCELLED"]:e.ACCEPTED=["DELIVERED","CANCELLED"],"onsite"===d&&(e.CREATED=["ACCEPTED","CANCELLED"]),e[a]&&-1!==e[a].indexOf(b)?!0:!1}}}]),angular.module("merchantApp").filter("payment",function(){return function(a){switch(a){case"online":return"在线支付";case"onsite":return"货到付款";default:return"不明错误"}}}),angular.module("merchantApp").filter("delivery",function(){return function(a){switch(a){case"self":return"自提";case"express":return"快递";default:return"不明错误"}}}),angular.module("merchantApp").service("merchandise",["api","scroll",function(a,b){var c=null;return{initScroll:function(a,c,d,e){var f=!1,g=this;console.log("sindie scroll"),console.log(a),b.bottom(a,function(){f||(c(),e.page++,g.list(e,function(a){a.results.length<1&&(f=!0),d(a)}))})},list:function(b,c){a.send("merchandise/list",b,function(a){"Success"===a.name?c(a.data):c()})},query:function(b,c){a.send("merchandise/query",b,function(a){"Success"===a.name?c(a.data):c()})},add:function(b,c){a.send("merchandise/add",b,function(a){switch(a.name){case"Success":alert("添加成功！")}c()})},inputSearch:function(a,b,d){function e(){f.query(g,d)}var f=this,g={q:a};c&&clearTimeout(c),c=setTimeout(e,3e3)},online:function(b,c){a.send("merchandise/online",{id:b.merchandise.id,online:!0},function(a){b.online=!0,"Success"===a.name&&c&&c()})},offline:function(b,c){a.send("merchandise/online",{id:b.merchandise.id,online:!1},function(a){console.log(a),b.online=!1,"Success"===a.name&&c&&c()})},remove:function(b,c){a.send("merchandise/remove",{id:b.merchandise.id},function(a){switch(a.name){case"Success":c&&c()}})}}}]),angular.module("merchantApp").service("category",["api","$location","scroll",function(a,b,c){var d;return{list:function(b,c){a.send("category/list",{page:b},function(a){"Success"===a.name?c(a.data):c()})},add:function(c){a.send("category/create",c,function(a){"Success"===a.name?(alert("添加成功！"),b.path("category/list")):alert("添加失败！ 原因："+a.message)})},update:function(c){a.send("category/update",c,function(a){console.log(a),"Success"===a.name?(alert("修改成功！"),b.path("/category/list")):alert("修改失败！ 原因："+a.message)})},query:function(b,c){a.send("category/query",b,function(a){"Success"===a.name?c(a.data):c()})},inputSearch:function(a,b,c){function e(){f.query(g,c)}var f=this,g={q:a};d&&clearTimeout(d),d=setTimeout(e,3e3)},initScroll:function(a,b,d,e){var f=!1,g=this;console.log("sindie scroll"),console.log(a),c.bottom(a,function(){f||(b(),g.list(e++,function(a){a.results.length<1&&(f=!0),d(a)}))})},online:function(b,c){a.send("category/online",{id:b.id,online:!0},function(a){console.log(a),"Success"===a.name&&(b.online=!0,c&&c())})},offline:function(b,c){a.send("category/online",{id:b.id,online:!1},function(a){console.log(a),"Success"===a.name&&(b.online=!1,c&&c())})},remove:function(b,c){a.send("category/remove",{id:b.id},function(a){console.log(a),"Success"===a.name&&c&&c()})}}}]),angular.module("merchantApp").service("barcode",["api","scroll",function(a,b){return{list:function(b,c){a.send("barcode/list",{page:b},function(a){"Success"===a.name?c(a.data):c()})},initScroll:function(a,c,d,e){var f=!1,g=this;console.log("sindie scroll"),console.log(a),b.bottom(a,function(){f||(c(),g.list(e++,function(a){a.results.length<1&&(f=!0),d(a)}))})}}}]),angular.module("merchantApp").service("grocery",["api","NgMap",function(a,b){function c(a){return function(b){"Success"===b.name?a(b.data):a()}}var d,e,f=!1;return{notLoaded:!0,request:function(b){a.send("merchant/verify",{},c(b))},profile:function(b){a.send("store/profile",{},c(b))},update:function(b,d){a.send("store/update",b,c(d))},locationUpdate:function(b){a.send("location/update",b,function(a){"Success"===a.name?alert("位置更新成功！"):alert(a.message)})},getMap:function(a){function c(){b.getMap().then(function(b){f||(f=!0,a(b),clearInterval(e))})}e=setInterval(c,1e3)},onMap:function(a,b){if(!d){var c=new google.maps.LatLng(34.7,98.2);d=new google.maps.Marker({map:a,position:c}),d.setMap(a)}google.maps.event.addListener(a,"click",function(a){console.log(a.latLng),console.log(a.latLng.lat()),console.log(a.latLng.lng()),d.setPosition(a.latLng),b(a.latLng)})},online:function(b){a.send("online",{},c(b))},offline:function(b){a.send("offline",{},c(b))}}}]),angular.module("merchantApp").service("images",function(){return{preview:function(a,b){function c(a){var c=new FileReader;c.readAsDataURL(a),c.onload=function(a){b(a.target.result)}}if(a)for(var d=0;d<a.length;d++)c(a[d])}}}),angular.module("merchantApp").service("scroll",function(){return{bottom:function(a,b){console.log("inside on scroll"),console.log("selector:"+a),angular.element(document).find(a).unbind(),angular.element(document).find(a).on("scroll",function(){console.log("inside on scroll");var a=this.scrollHeight-this.scrollTop,c=this.clientHeight;a===c&&b&&b(this.scrollTop)})}}}),angular.module("merchantApp").service("weixin",["api",function(a){var b=["checkJsApi","scanQRCode","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"];return{configurated:!1,fail:function(a){alert("微信JSSDK配置失败！"),alert(a.errMsg)},share:function(a,b,c){b.title=b.title||"田一块小卖部",b.link=b.link||"http://m.t1bao.com",b.imgUrl=b.imgUrl||"http://www.t1bao.com/images/logo.png",alert(JSON.stringify(b)),b.success=function(){alert("分享成功！")},b.cancel=function(){},wx||alert("请在微信下面分享!");var d=this;if(!this.configurated)return this.init(function(){d.share(a,b,c)});switch(a){default:wx.onMenuShareTimeline(b)}c&&c()},scan:function(a){var b=this;return this.configurated?void wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(b){var c=b.resultStr;a(c)}}):this.init(function(){b.scan(a)})},success:function(){this.configurated=!0},onRequest:function(a){var c=this;return function(d){var e={};for(var f in d.data)e[f]=d.data[f];e.jsApiList=b,e.timestamp=parseInt(e.timestamp),wx.config(e),wx.ready(function(){c.success(),a()}),wx.error(function(){c.fail(),a()})}},init:function(b){var c="api/jssdk/config";a.selfSend(c,{url:location.origin+location.pathname},this.onRequest(b),null,"weixin/")}}}]),angular.module("merchantApp").controller("PreviewCtrl",["$scope","$location","$route","preview",function(a,b,c,d){console.log(c.current.$$route.originalPath);var e=1;switch(a.module="grocery",a.listed=!1,a.getCategory=function(b){function c(c){var e={page:c};b.id&&(e.category=b.id),d.merchandise(e,function(b){1===c?a.merchandises=b.results:a.merchandises=a.merchandises.concat(b.results),a.listed=!0})}a.column="default",a.listed=!1,e=1,a.merchandises=[],b||(b={id:0}),$(".list-group-item.active").removeClass("active"),$(".list-group-item").each(function(){var a=$(this).attr("id");a==="category-"+b.id&&$(this).addClass("active")}),c(e)},c.current.$$route.originalPath){case"/preview/home":a.column="default",d.category(e,function(b){console.log(b),a.fetched=!0,a.infoList=!0,a.categories=b.results}),a.getCategory();break;case"/preview/profile":a.column="profile",d.profile(function(b){console.log(b),a.profiled=!0,a.fetched=!0,a.grocery=b});break;case"/preview/comments":a.column="comments",d.comments(e,function(){a.fetched=!0,a.comments=!0})}a.showInfo=function(){a.column="default",b.path("preview/home")},a.showProfile=function(){a.column="profile",b.path("preview/profile")},a.showComments=function(){a.column="comments",b.path("preview/comments")}}]),angular.module("merchantApp").service("preview",["api",function(a){return{category:function(b,c){a.send("preview/category",{page:b},function(a){"Success"===a.name?c(a.data):c()})},profile:function(b){a.send("preview/profile",{},function(a){"Success"===a.name?b(a.data):b()})},merchandise:function(b,c){a.send("preview/merchandise",b,function(a){"Success"===a.name?c(a.data):c()})},comments:function(a,b){b()}}}]),angular.module("merchantApp").filter("distance",function(){return function(a){return"distance filter: "+a}}),angular.module("merchantApp").run(["$templateCache",function(a){a.put("views/category/add.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"> <a href="#/merchandise/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-8">添加分类</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal subcategory add" role="form" enctype="multipart/form-data"> <input type="hidden" name="id" ng-model="id" value="{{id}}"> <div class="form-group android-list"> <label for="name" class="col-sm-2 control-label">分类名称</label> <div class="col-sm-10"> <input type="text" class="form-control" id="name" name="name" placeholder="请输入分类名称" ng-model="name"> </div> </div> <div class="form-group android-list"> <label for="order" class="col-sm-2 control-label">分类序号</label> <div class="col-sm-10"> <input type="text" class="form-control" id="order" name="order" placeholder="请输入分类排序号,必须是整数" ng-model="order"> </div> </div> <div class="form-group android-list no-line"> <div class="col-xs-12 text-center"> <button type="button" class="btn btn-danger btn-block" ng-click="add()">添加</button> </div> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/category/edit.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"> <a href="#/category/list"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-8">分类修改</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal category update" role="form" enctype="multipart/form-data"> <input type="hidden" name="id" value="{{category.id}}" ng-model="category.id"> <div class="form-group android-list"> <label for="mod-name" class="col-sm-2 control-label">分类名称</label> <div class="col-sm-10"> <input type="text" class="form-control" id="mod-name" name="name" ng-model="category.name"> </div> </div> <div class="form-group android-list"> <label for="order" class="col-sm-2 control-label">分类序号</label> <div class="col-sm-10"> <input type="text" class="form-control" id="order" name="order" placeholder="请输入分类排序号" ng-model="category.order"> </div> </div> <div class="form-group android-list no-line"> <div class="col-xs-12 text-center"> <button type="button" class="btn btn-danger btn-block" ng-click="update()">修改</button> </div> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/category/list.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a ng-href="#/merchandise/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> <a class="btn dropdown-toggle" type="button" id="category-dropdown" data-toggle="dropdown" aria-expanded="true"> 分类列表 </a> </div> <div class="col-md-3 col-xs-3"> <a ng-href="#/merchandise/search"> <i class="fa fa-search"></i> </a> &nbsp; </div> </div> </div> </div> <div class="body-bar"> <div class="merchandise-list margin-top"> <div class="list list-bar" ng-repeat="category in categories track by $index"> <div class="list-text-item"><span>ID:</span>{{category.id}}</div> <div class="list-text-item"><span>分类名:</span>{{category.name || ""}}</div> <div class="list-text-item"><span>排序号:</span>{{category.order || ""}}</div> <div class="list-text-item"> <button class="btn btn-warning" ng-show="!category.online" ng-click="online(category);$event.stopPropagation()">上线 </button> <button class="btn btn-success" ng-show="category.online" ng-click="offline(category);$event.stopPropagation()">下线 </button> <a class="btn btn-info" href="#/category/edit/{{category.id}}">修改 </a> <button class="btn btn-danger" ng-click="remove(category);$event.stopPropagation()">删除</button> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/footer.html",'<div class="footer-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <div class="tool-bar order" ng-class="{\'active\': module == \'grocery\'}"> <p><a href="#/grocery/home"><i class="fa fa-home"></i>店铺</a></p><b></b></div> </div> <div class="col-md-3 col-xs-3"> <div class="tool-bar grocery" ng-class="{\'active\': module == \'order\'}"> <p><a href="#/order/home"><i class="fa fa-file-text"></i>订单</a></p><b></b></div> </div> <div class="col-md-3 col-xs-3"> <div class="tool-bar cart" ng-class="{\'active\': module == \'merchandise\'}"> <p><a href="#/merchandise/home"><i class="fa fa-shopping-cart"></i>商品</a></p><b></b></div> </div> <div class="col-md-3 col-xs-3"> <div class="tool-bar user last" ng-class="{\'active\': module == \'user\'}"> <p><a href="#/user/home"><i class="fa fa-user"></i>店长</a></p><b></b></div> </div> </div> </div> </div>'),a.put("views/grocery/edit-content.html",'<div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal grocery modify pad" role="form" enctype="multipart/form-data"> <div class="form-group"> <label class="col-sm-2 control-label">门店名称:</label> <div class="col-sm-10"> <input type="email" class="form-control" ng-model="grocery.name" name="name" placeholder="名称" required> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">门店电话:</label> <div class="col-sm-10"> <input type="tel" class="form-control" ng-model="grocery.phone" name="phone" placeholder="电话" required> </div> </div> <div class="form-group no-line"> <label class="col-sm-2 control-label">营业时间:</label> <div class="col-sm-10"> <div class="input-group"> <span class="input-group-addon">开始<code class="hidden-xs">时间</code> </span> <input type="time" class="form-control datepicker" placeholder="请输入开始时间" aria-describedby="开始时间" ng-value="grocery.start_time" name="start_time" required> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"></label> <div class="col-sm-10"> <div class="input-group"> <span class="input-group-addon">结束<code class="hidden-xs">时间</code> </span> <input type="time" class="form-control datepicker" placeholder="请输入结束时间" aria-describedby="结束时间" ng-value="grocery.end_time" name="end_time" required> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">门店地址:</label> <div class="col-sm-10"> <input type="text" class="form-control" ng-model="grocery.address" name="address" placeholder="地址" required> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">门店介绍:</label> <div class="col-sm-10"> <textarea class="form-control" ng-model="grocery.intro" name="intro" placeholder="介绍" required></textarea> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">门店logo:</label> <div class="col-sm-10"> <img ng-src="{{grocery.logo.url}}" ng-show="grocery.logo.url" class="image-uploader grocery-edit-image-{{grocery.logo.id}}" ng-click="removeImage(grocery.logo.id)"> <div class="image-uploader"> <input type="file" class="form-control" id="mod-file" name="logo" placeholder="请输入图片"> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">配送选项:</label> <div class="col-sm-10"> <div class="radio"> <label> <input type="radio" name="delivery" value="true" ng-checked="grocery.delivery"> 支持 </label> </div> <div class="radio"> <label> <input type="radio" name="delivery" value="false" ng-checked="!grocery.delivery" ng-click="disableDelivery()"> 不支付 </label> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">起送金额:</label> <div class="col-sm-10"> <input class="form-control" ng-model="grocery.delivery_limit" name="delivery_limit" placeholder="0.0" required> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">最远配送距离:</label> <div class="col-sm-10"> <input class="form-control" ng-model="grocery.delivery_distance" name="delivery_distance" placeholder="0.0" required> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">最低配送费:</label> <div class="col-sm-10"> <input class="form-control" ng-model="grocery.delivery_fee" name="delivery_fee" placeholder="0.0" required> </div> </div> <div class="form-group"> <div class="col-xs-12"> <a type="button" class="btn btn-danger btn-block" ng-click="modify(grocery)">保存</a> </div> </div> </form> </div> </div> </div>'),a.put("views/grocery/edit.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"></div> <div class="col-md-6 col-xs-6"> 店铺信息 </div> <div class="col-md-3 col-xs-3"> <a type="button" class="btn" ng-click="modify(grocery)">保存</a> </div> </div> </div> </div> <div class="body-bar"> <div class="tab-bar"> <div class="row"> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'profile\'}"> <p> <a href="#/grocery/settings"> 设置 </a> </p> </div> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'location\'}"> <p> <a href="#/grocery/location"> 定位 </a> </p> </div> </div> </div> <div ng-include src="\'views/grocery/edit-content.html\'" class="tab-body-bar"></div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/grocery/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <!--<i class="ifa ifa-scan" ng-click="scan()"></i>--> </div> <div class="col-md-6 col-xs-6"> 我的店铺 </div> <div class="col-md-3 col-xs-3"> <!--<i class="fa fa-refresh" ng-click="reload()"></i>--> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item settings" ng-click="click(\'settings\')"> <i class="fa fa-gear"></i> <span>店铺设置</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item position" ng-click="click(\'position\')"> <i class="fa fa-map-marker"></i> <span>店铺定位</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item preview" ng-click="click(\'preview\')"> <i class="fa fa-eye"></i> <span>店铺预览</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item barcode" ng-click="click(\'search\')"> <i class="fa fa-search"></i> <span>搜索</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item share" ng-click="click(\'share\')"> <i class="fa fa-share-alt"></i> <span>分享店铺</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item payment" ng-click="click(\'payment\')"> <i class="fa fa-credit-card"></i> <span>支付设置</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item subscribers" ng-click="click(\'subscribers\')"> <i class="fa fa-users"></i> <span>订阅用户</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item comments disabled" ng-click="click(\'comments\')"> <i class="bubble" ng-show="comments.length"> {{comments.length}} </i> <i class="fa fa-comments"></i> <span>用户评论</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item feedback" ng-click="click(\'feedback\')"> <i class="bubble" ng-show="feedbacks.length"> {{feedbacks.length}} </i> <i class="fa fa-commenting"></i> <span>意见反馈</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item system-message disabled" ng-click="click(\'messages\')"> <i class="bubble" ng-show="messages.length"> {{messages.length}} </i> <i class="fa fa-envelope"></i> <span>系统消息</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item income disabled" ng-click="click(\'income\')"> <i class="fa fa-rmb"></i> <span>收入详情</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item traffic disabled" ng-click="click(\'traffic\')"> <i class="fa fa-bar-chart"></i> <span>流量统计</span> </a> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/grocery/location-content.html",'<div class="container"> <div class="row"> <div class="col-sm-12"> <div class="map-controller"> <table style="width:100%"> <tr> <td>纬度:</td> <td><span class="latitude">{{latitude || \'0.00\'}}</span></td> <td rowspan="2"><a class="btn btn-danger" ng-click="saveLocation()">保存</a></td> </tr> <tr> <td>经度: </td> <td><span class="longitude">{{longitude || \'0.00\'}}</span></td> </tr> </table> <p class="alert alert-info text-center"> 请点击地图设置门店位置 </p> </div> </div> <div class="map" map-lazy-load="http://maps.google.cn/maps/api/js?region=cn&language=zh-CN&key=AIzaSyBtvL35LnY7dsDvbqhSNo-QENP76Za1wEw" map-lazy-load-params=""> <p class="alert alert-danger text-center" ng-show="notLoaded">正在加载地图信息，请耐心等待...</p> <ng-map center="34.7, 98.2" zoom="3"> <!-- <marker position="{{latitude || 34.7}}, {{longitude || 98.2}}"></marker> --> </ng-map> </div> </div> </div>'),a.put("views/grocery/location.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"></div> <div class="col-md-6 col-xs-6"> 位置设置 </div> <div class="col-md-3 col-xs-3"> </div> </div> </div> </div> <div class="body-bar"> <div class="tab-bar"> <div class="row"> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'profile\'}"> <p> <a href="#/grocery/settings"> 设置 </a> </p> </div> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'location\'}"> <p> <a href="#/grocery/location"> 定位 </a> </p> </div> </div> </div> <div ng-include src="\'views/grocery/location-content.html\'" class="tab-body-bar"></div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/grocery/profile.html",'<div class="list pad"> <div class="list-text-item"> <span>门店名称:</span> {{grocery.name}} &nbsp; </div> <div class="list-text-item"> <span>门店电话:</span> {{grocery.phone}} &nbsp; </div> <div class="list-text-item"> <span>营业时间:</span> <i ng-model="start_time">{{grocery.start_time}}</i> 至 <i ng-model="end_time">{{grocery.end_time}}</i> </div> <div class="list-text-item"> <span>门店地址:</span> {{grocery.address}} &nbsp; </div> <div class="list-text-item"> <span>门店介绍:</span><i class="text-left">{{grocery.intro}} &nbsp;</i> </div> <div class="list-text-item"> <span>门店logo:</span> <img ng-src="{{grocery.logo}}" height="50px"> <a ng-href="{{grocery.logo}}" target="_blank"></a> </div> <div class="list-text-item"> <span>是否配送:</span> {{grocery.delivery ? \'是\' : \'否\'}} &nbsp; </div> <div class="list-text-item"> <span>配送距离:</span> {{grocery.delivery_distance}} &nbsp; </div> <div class="list-text-item"> <span>起送额:</span> {{grocery.delivery_limit}} &nbsp; </div> <div class="list-text-item"> <span>送货费:</span> {{grocery.delivery_fee}} &nbsp; </div> <div class="list-text-item" ng-show="grocery.approved !== \'APPROVED\'"> <span>申请审核:</span> <p class="form-control-static" ng-switch on="grocery.approved"> <button class="btn btn-default" ng-show="grocery.approved  !== \'APPROVED\'" ng-click="verfiy()">申请审核</button> </p> </div> <div class="list-text-item"> <span>是否通过审核:</span> <code class="form-control-static" ng-switch on="grocery.approved"> <i ng-switch-when="APPROVED">审核通过</i> <i ng-switch-when="REJECTED">审核未通过</i> <i ng-switch-when="UNCHECKED">尚未审核</i> <i ng-switch-default>尚未审核</i> </code> </div> <div class="list-text-item"> <span>上线管理:</span> <code class="form-control-static" ng-switch on="grocery.online"> <i ng-switch-when="true">已上线</i> <i ng-switch-when="false">未上线</i> </code> &nbsp; <button class="btn btn-default" ng-show="grocery.online" ng-click="offline()">下线</button> <button class="btn btn-default" ng-show="!grocery.online" ng-click="online()">上线</button> </div> </div> <div class="container"> <div class="row"> <div class="col-xs-12"> </div> </div> </div>'),a.put("views/grocery/settings.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"></div> <div class="col-md-6 col-xs-6"> 店铺信息 </div> <div class="col-md-3 col-xs-3"> <a class="" ng-href="#/grocery/edit"> <i class="fa fa-edit"></i> </a> </div> </div> </div> </div> <div class="body-bar"> <div class="tab-bar"> <div class="row"> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'profile\'}"> <p> <a href="#/grocery/settings"> 设置 </a> </p> </div> <div class="col-md-6 col-xs-6" ng-class="{\'active\': type === \'location\'}"> <p> <a href="#/grocery/location"> 定位 </a> </p> </div> </div> </div> <div ng-include src="\'views/grocery/profile.html\'" class="tab-body-bar"></div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/merchandise/add.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"> <a href="#/merchandise/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-8">商品添加</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal merchandise add" role="form" enctype="multipart/form-data"> <div class="form-group"> <label for="name" class="col-sm-2 control-label">商品名称<span>*</span></label> <div class="col-sm-10"> <input type="text" class="form-control" id="name" ng-model="name" name="name" placeholder="请输入商品名称"> </div> </div> <div class="form-group"> <label for="desc" class="col-sm-2 control-label">介绍</label> <div class="col-sm-10"> <textarea class="form-control" rows="3" id="desc" ng-model="desc" name="desc" placeholder="请输入介绍信息"></textarea> </div> </div> <div class="form-group"> <label for="brand" class="col-sm-2 control-label">品牌</label> <div class="col-sm-10"> <input type="text" class="form-control" id="brand" name="brand" placeholder="请输入品牌"> </div> </div> <div class="form-group"> <label for="brand" class="col-sm-2 control-label">分类</label> <div class="col-sm-10"> <select type="text" class="form-control" id="category" name="category" placeholder="请选择分类"> <option>请选择分类</option> <option ng-repeat="category in categories" ng-value="category.id"> {{category.name}} </option> </select> </div> </div> <div class="form-group"> <label for="price" class="col-sm-2 control-label">价格</label> <div class="col-sm-10"> <input type="text" class="form-control" id="price" name="price" placeholder="请输入价格"> </div> </div> <div class="form-group"> <label for="file" class="col-sm-2 control-label">图片</label> <div class="col-sm-10"> <div class="image-uploader"> <input type="file" class="form-control" id="file" name="image" placeholder="请添加相关图片" multiple> </div> </div> </div> <div class="form-group"> <div class="col-sm-12 col-xs-12"> <button type="button" class="btn btn-danger btn-block" ng-click="add()">添加</button> </div> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/merchandise/edit.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"> <a href="#/merchandise/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-8">商品修改</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal merchandise modify" role="form" enctype="multipart/form-data"> <input type="hidden" name="id" value="{{merchandise.id}}" ng-model="merchandise.id"> <div class="form-group"> <label for="mod-name" class="col-sm-2 control-label">商品名称<span>*</span> </label> <div class="col-sm-10"> <input type="text" class="form-control" id="mod-name" name="name" placeholder="请输入商品名称" ng-model="merchandise.name"> </div> </div> <div class="form-group"> <label for="mod-price" class="col-sm-2 control-label">价格</label> <div class="col-sm-10"> <input type="text" class="form-control" id="mod-price" name="price" placeholder="请输入商品价格" ng-model="merchandise.price" value="{{merchandise.price | currency}}"> </div> </div> <div class="form-group"> <label for="mod-desc" class="col-sm-2 control-label">介绍</label> <div class="col-sm-10"> <textarea class="form-control" rows="3" id="mod-desc" name="desc" placeholder="请输入介绍信息" ng-model="merchandise.desc"></textarea> </div> </div> <div class="form-group"> <label for="mod-brand" class="col-sm-2 control-label">品牌</label> <div class="col-sm-10"> <input type="text" class="form-control" id="mod-brand" name="brand" placeholder="请输入品牌" ng-model="merchandise.brand"> </div> </div> <div class="form-group"> <label for="mod-category" class="col-sm-2 control-label">分类</label> <div class="col-sm-10"> <select type="text" class="form-control" id="mod-category" name="category" placeholder=""> <option ng-repeat="category in categories" value="{{category.id}}"> {{category.name}} </option> </select> </div> </div> <div class="form-group"> <label for="mod-file" class="col-sm-2 control-label">图片</label> <div class="col-sm-10"> <img class="image-uploader merchandise-edit-image-{{merchandise.images[$index].id}}" ng-repeat="image in merchandise.images track by $index" ng-src="{{image.url}}" ng-click="removeImage(merchandise.id, merchandise.images[$index].id)"> <div class="image-uploader"> <input type="file" class="form-control" id="mod-file" name="image" placeholder="请选择图片"> </div> </div> </div> <div class="form-group no-line"> <div class="col-xs-12 col-xs-12"> <button type="button" class="btn btn-danger btn-block" ng-click="modify()">修改</button> </div> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/merchandise/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <!--<i class="ifa ifa-scan" ng-click="scan()"></i>--> </div> <div class="col-md-6 col-xs-6"> 商品管理 </div> <div class="col-md-3 col-xs-3"> <a href="#/search/merchandise"> <i class="fa fa-search"></i> </a> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item position" href="#/category/add"> <i class="fa fa-plus"></i> <span>添加分类</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item settings" href="#/category/list"> <i class="fa fa-gear"></i> <span>分类列表</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item preview" ng-click="click(\'preview\')"> <i class="fa fa-home"></i> <span>商品分类</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item merchandise" href="#/merchandise/add"> <i class="fa fa-plus"></i> <span>添加商品</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item category" href="#/merchandise/list/1"> <i class="fa fa-reorder"></i> <span>商品列表</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item barcode" ng-click="click(\'barcode\')"> <i class="fa fa-list-ol"></i> <span>商品排行</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item subscribers" ng-click="scan()"> <i class="fa ifa ifa-scan"></i> <span>条码扫描</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item comments" ng-click="click(\'comments\')"> <i class="bubble" ng-show="comments.length"> {{comments.length}} </i> <i class="fa fa-barcode"></i> <span>条码列表</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item feedback" ng-click="click(\'feedback\')"> <i class="bubble" ng-show="feedbacks.length"> {{feedbacks.length}} </i> <i class="fa fa-link"></i> <span>条码绑定</span> </a> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),
a.put("views/merchandise/list.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/merchandise/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6">商品列表</div> <div class="col-md-3 col-xs-3"> <i class="fa fa-chevron-up" ng-show="page > 1" ng-click="pageStep()"></i> &nbsp;<i class="fa fa-chevron-down" ng-click="pageStep(true)"></i> </div> </div> </div> </div> <div class="body-bar"> <div class="tab-bar"> <div class="row"> <div class="col-xs-4"> <div class="dropdown"> <a class="btn dropdown-toggle" type="button" id="category-dropdown" data-toggle="dropdown" aria-expanded="true"> 分类&nbsp;<span class="caret"></span> </a> <ul class="dropdown-menu" role="menu" aria-labelledby="category-dropdown"> <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="selectCategory({name:\'全部分类\', value: \'all\'})">全部分类</a> </li> <li role="presentation" ng-repeat="category in categories"> <a role="menuitem" tabindex="-1" ng-click="selectCategory(category)">{{category.name}}</a> </li> </ul> </div> </div> <div class="col-xs-4"> <div class="dropdown"> <a class="btn dropdown-toggle" type="button" id="order-dropdown" data-toggle="dropdown" aria-expanded="true"> 排序&nbsp;<span class="caret"></span> </a> <ul class="dropdown-menu" role="menu" aria-labelledby="order-dropdown"> <li role="presentation" ng-repeat="order in orders"> <a role="menuitem" tabindex="-1" ng-click="selectOrder(order)">{{order.name}}</a> </li> </ul> </div> </div> <div class="col-xs-4"> <div class="dropdown"> <a class="btn dropdown-toggle" type="button" id="online-dropdown" data-toggle="dropdown" aria-expanded="true"> 上下线&nbsp;<span class="caret"></span></a> <ul class="dropdown-menu" role="menu" aria-labelledby="online-dropdown"> <li role="presentation"> <a role="menuitem" tabindex="-1" ng-click="selectOnline(\'all\')">全部</a> </li> <li role="presentation"> <a role="menuitem" tabindex="-1" ng-click="selectOnline(\'online\')">上线</a> </li> <li role="presentation"> <a role="menuitem" tabindex="-1" ng-click="selectOnline(\'offline\')">下线</a> </li> </ul> </div> </div> </div> </div> <div class="tab-body-bar"> <div class="row nomargin list list-item" ng-repeat-start="sm in merchandises track by $index"> <div class="col-xs-3 clear-text"> <img ng-repeat="image in sm.images" ng-src="{{image.url}}" alt="{{image.hash}}" class="image-uploader"> </div> <div class="col-xs-6 clear-text"> {{sm.merchandise.name || \'&nbsp;\'}} </div> <div class="col-xs-3 clear-text"> <div class="pointer vertical-center"> <i class="fa fa-chevron-down" id="show-item-{{sm.id}}" ng-click="showItem(sm.id)"></i> <i class="fa fa-chevron-up hidden" id="hide-item-{{sm.id}}" ng-click="hideItem(sm.id)"></i> </div> </div> </div> <div class="list list-bar hidden" ng-repeat-end id="list-{{sm.id}}"> <div class="list-text-item"><span>ID:</span>{{sm.id}}</div> <div class="list-text-item"><span>商品名:</span>{{sm.merchandise.name || \'&nbsp;\'}}</div> <div class="list-text-item"><span>品牌:</span>{{sm.merchandise.brand || \'&nbsp;\'}}</div> <div class="list-text-item"><span>价格:</span>{{sm.price | currency}}</div> <div class="list-text-item"><span>商品描述:</span><br>{{sm.merchandise.desc || \'&nbsp;\'}}</div> <div class="list-text-item"><span>分类:</span>{{sm.category.name || \'&nbsp;\'}}</div> <div class="list-text-item"><span>图片:</span><img ng-repeat="image in sm.images" ng-src="{{image.url}}" alt="{{image.hash}}" class="image-uploader"></div> <div class="list-text-item"> <button class="btn btn-warning" ng-show="!sm.online" ng-click="online(sm);$event.stopPropagation()">上线 </button> <button class="btn btn-success" ng-show="sm.online" ng-click="offline(sm);$event.stopPropagation()">下线 </button> <a class="btn btn-info" href="#/merchandise/edit/{{sm.id}}">修改 </a> <button class="btn btn-danger" ng-click="remove(sm);$event.stopPropagation()">删除</button> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/order/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <i class="ifa ifa-arr" ng-click="scan()"></i> </div> <div class="col-md-6 col-xs-6"> 订单详情 </div> <div class="col-md-3 col-xs-3"> <a href="#/search/order"> <i class="fa fa-search"></i> </a> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item orders" ng-href="#/order/created/list/1"> <i class="bubble" ng-show="orders.length"> {{orders.length}} </i> <i class="fa fa-file-text"></i> <span>新订单</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item share" ng-href="#/order/accepted/list/1"> <i class="bubble" ng-show="messages.length"> {{messages.length}} </i> <i class="fa fa-file-text"></i> <span>待处理订单</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item system-message" ng-href="#/order/delivered/list/1"> <i class="bubble" ng-show="messages.length"> {{messages.length}} </i> <i class="fa fa-file-text"></i> <span>已经发货</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item merchandise" ng-href="#/order/received/list/1"> <i class="fa fa-file-text"></i> <span>已经接收</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item category" ng-href="#/order/cancelled/list/1"> <i class="fa fa-file-text"></i> <span>已经取消</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item barcode" ng-href="#/order/commented/list/1"> <i class="fa fa-comments"></i> <span>已经评价</span> </a> </div> </div> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item finished" ng-href="#/order/finished/list/1"> <i class="fa fa-file-text"></i> <span>已经完成</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item finished" ng-href="#/order/all/list/1"> <i class="fa fa-file-text"></i> <span>所有订单</span> </a> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/order/list.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/order/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> {{title}} </div> <div class="col-md-3 col-xs-3"> <i class="fa fa-chevron-up" ng-click="previousPage()"></i> &nbsp;<i class="fa fa-chevron-down" ng-click="nextPage()"></i> </div> </div> </div> </div> <div class="body-bar order-list"> <div class="list list-bar" ng-repeat="order in orders track by $index"> <!-- Default panel contents --> <div class="list-text-item"><span>订单ID:</span>{{order.id}} </div> <div class="list-text-item"><span>订单状态：</span> &nbsp; <button class="btn btn-warning disable btn-xs" disabled ng-show="showState(order, \'CREATED\')">已创建 </button> <button class="btn btn-warning disable btn-xs" disabled ng-show="showState(order, \'CANCELLED\')">已取消 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'ACCEPTED\')">已接单 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'PAID\')">已支付 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'DELIVERED\')">已经发货 </button> <button class="btn btn-danger disable btn-xs" disabled ng-show="showState(order, \'UNREACHABLE\')">无法送达 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'RECEIVED\')">已收货 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'COMMENTED\')">已评价 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'FINISHED\')">已完成 </button> </div> <div class="list-text-item"><span>操作：</span>&nbsp; <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'ACCEPTED\')" ng-click="state(order.id, \'ACCEPTED\')">接单 </button> <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'DELIVERED\')" ng-click="state(order.id, \'DELIVERED\')">发货 </button> <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'FINISHED\')" ng-click="state(order.id, \'FINISHED\')">完成 </button> <button class="btn btn-danger btn-xs" ng-show="showTransState(order, \'CANCELLED\')" ng-click="state(order.id, \'CANCELLED\')">取消 </button> </div> <div class="list-text-item"><span>更多内容</span> <a id="order-detail-show-{{order.no}}" class="btn btn-xs" ng-click="showDetail(order)"><i class="fa fa-caret-down"></i> 详情</a><a id="order-detail-hide-{{order.no}}" class="btn btn-xs hidden" ng-click="hideDetail(order)"><i class="fa fa-caret-up"></i> 隐藏</a></div> <div class="hidden" id="order-detail-{{order.no}}"> <div class="list-text-item"><span>订单号：</span>{{order.no}}</div> <div class="list-text-item"><span>帐户：</span> <a target="user-info" href="#/user/info/{{order.user.id}}">{{order.user.username || \' \'}}</a></div> <div class="list-text-item"><span>下单时间：</span>{{order.createdAt | date}}</div> <div class="list-text-item"><span>接收人：</span>{{order.receiver || "&nbsp;"}}</div> <div class="list-text-item"><span>联系电话：</span>{{order.phone || "&nbsp;"}}</div> <div class="list-text-item"><span>支付方式：</span>{{order.payment | payment}}</div> <div class="list-text-item"><span>配送方式：</span>{{order.delivery | delivery}}</div> <div class="list-text-item"><span>送货地址：</span>{{order.address || "&nbsp;"}}</div> <div class="list-text-item"><span>总数量：</span>{{order.total || "&nbsp;"}}</div> <div class="list-text-item"><span>总价格：</span>{{order.summary | currency}}</div> <div class="inner-list" ng-repeat="merchandise in order.merchandises"> <div class="list-text-item"> <span>商品名：</span>{{merchandise.name || "&nbsp;"}} </div> <div class="list-text-item"> <span>图片：</span> <a ng-href="{{merchandise.url}}" target="merchandise"> <img style="width:40px;height:40px" ng-src="{{merchandise.url}}" alt="{{merchandise.name}}"></a> </div> <div class="list-text-item"> <span>品牌</span> {{merchandise.brand || "&nbsp;"}} </div> <div class="list-text-item"> <span>数量</span> {{merchandise.number || "&nbsp;"}} </div> <div class="list-text-item"> <span>单价</span> ¥ {{merchandise.price | currency}} </div> <div class="list-text-item"> <span>优惠价</span> {{merchandise.discount || "&nbsp;"}} </div> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/password/retrieve.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"></div> <div class="col-md-6 col-xs-8">密码找回</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="user-login"> <div class="form-group" ng-show="!checked"> <label for="image-captcha">图片验证码：</label> <p id="image-captcha"><span data="{{url}}captcha/image" ng-click="updateImage()"><img src="{{url}}captcha/image"> </span> <i class="fa fa-check-circle" ng-show="captcha && checked"></i> <i class="fa fa-times-circle" ng-show="captcha && !checked"> 验证码错误</i> </p> </div> <div class="form-group" ng-show="!checked"> <label>输入图片验证码：</label> <input name="captchaImage" type="text" class="form-control" placeholder="验证码"> <br> <p class="text-info">验证码正确后，找回流程会自动开启</p> </div> <!--<div class="form-group" ng-show="!retrievePhone && checked">\n            <label for="email">输入注册邮箱</label>\n            <input type="email" required class="form-control" id="email" placeholder="请输入注册邮箱" name="email" ng-model="email">\n          </div>--> <div class="form-group" ng-show="retrievePhone && checked"> <label for="phone">输入注册手机号</label> <input type="text" required class="form-control" id="phone" placeholder="请输入注册手机号" name="phone" ng-model="phone"> </div> <p class="center"> <button type="button" class="btn btn-danger btn-block" ng-class="{disabled: !checked}" ng-click="retrieve(retrievePhone)">找回密码</button> </p> <!--<p class="center">\n            <a ng-click="retrievePassword()" ng-show="!retrievePhone">通过手机找回</a>\n            <a ng-click="retrieveSwitch(false)" ng-show="retrievePhone">通过邮箱找回</a>\n          </p>--> <hr> <p class="alert-default" role="alert"> 没有账号?马上 <a class="btn btn-warning" href="#/user/register">注册</a> </p> <p class="alert-primary text-right" role="alert"> 已经有账号？马上 <a class="btn btn-default" href="#/user/login">登录</a> </p> </form> </div> </div> </div> </div> <!-- /container --> <div ng-include src="\'views/modal.html\'"></div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/pay/alipay-form.html",'<br> <div class="alert alert-info" role="alert">正在开发中...敬请关注</div>'),a.put("views/pay/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <i class="fa fa-scan" ng-click="scan()"></i> </div> <div class="col-md-6 col-xs-6"> 支付设置 </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item orders" ng-href="#/payment/settings/weixin"> <i class="fa fa-weixin"></i> <span>微信支付</span> </a> </div> <!--<div class="col-md-4 col-xs-4">\n        <a class="native-item share disabled" ng-click="click(\'share\')">\n          <i class="fa fa-share-alt"></i>\n          <span>分享店铺</span>\n        </a>\n      </div>\n      <div class="col-md-4 col-xs-4">\n        <a class="native-item system-message disabled" ng-click="click(\'messages\')">\n          <i class="bubble" ng-show="messages.length">\n            {{messages.length}}\n          </i>\n          <i class="fa fa-envelope"></i>\n          <span>系统消息</span>\n        </a>\n      </div>--> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/pay/main.html",""),a.put("views/pay/weixin-form.html",'<br> <form class="form-horizontal weixin"> <div class="form-group"> <label for="app-id" class="col-sm-2 control-label">App ID</label> <div class="col-sm-10"> <input type="text" class="form-control" id="app-id" ng-model="weixin.app_id" name="app_id" placeholder="App Id"> </div> </div> <div class="form-group"> <label for="app-secret" class="col-sm-2 control-label">App Secret</label> <div class="col-sm-10"> <input type="text" class="form-control" id="app-secret" ng-model="weixin.app_secret" name="app_secret" placeholder="App Secret"> </div> </div> <div class="form-group"> <label for="app-token" class="col-sm-2 control-label">App Token</label> <div class="col-sm-10"> <input type="text" class="form-control" id="app-token" ng-model="weixin.app_token" name="app_token" placeholder="App Token"> </div> </div> <div class="form-group"> <label for="merchant-id" class="col-sm-2 control-label">商家ID</label> <div class="col-sm-10"> <input type="text" class="form-control" id="merchant-id" ng-model="weixin.merchant_id" name="merchant_id" placeholder="Merchant ID"> </div> </div> <div class="form-group"> <label for="merchant-key" class="col-sm-2 control-label">商家Key</label> <div class="col-sm-10"> <input type="text" class="form-control" id="merchant-key" ng-model="weixin.merchant_key" name="merchant_key" placeholder="Merchant Key"> </div> </div> <div class="form-group"> <label for="merchant_pfx" class="col-sm-2 control-label">签名文件(.p12)</label> <div class="col-sm-10"> <input type="file" class="form-control" id="merchant_pfx" name="merchant_pfx" accept=".p12" placeholder="签名文件"> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-default" ng-click="weixinSet()">设置</button> </div> </div> </form>'),a.put("views/preview/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/grocery/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6">{{grocery.name}}(预览)</div> <div class="col-md-3 col-xs-3"> <a> <i class="fa fa-heart"></i> </a> </div> </div> </div> </div> <div class="body-bar"> <div class="tab-bar"> <div class="row menu"> <div class="col-md-4 col-xs-4" ng-class="{\'active\': column == \'default\'}" ng-click="showInfo()"> <p role="menuitem" tabindex="-1"> <i class="fa fa-tags"></i> <span>商品</span> </p> </div> <div class="col-md-4 col-xs-4" ng-class="{\'active\': column == \'profile\'}" ng-click="showProfile()"> <p role="menuitem" tabindex="-1"> <i class="fa fa-info"></i> <span>介绍</span> </p> </div> <div class="col-md-4 col-xs-4" ng-class="{\'active\': column == \'comments\'}" ng-click="showComments()"> <p role="menuitem" tabindex="-1"> <i class="fa fa-comments"></i> <span>评论</span> </p> </div> </div> <div class="row nomargin grocery-merchandise" ng-show="!fetched"> <div class="col-md-12 col-xs-12"> <div class="row no-merchandise loading" ng-show="!listed && !fetched"> <div class="jumbotron"> <div class="container"> <div class="progress"> <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div> </div> <div class="alert alert-warning" role="alert"> 正在加载信息... </div> </div> </div> </div> </div> </div> <div class="row nomargin" ng-show="fetched && infoList"> <div class="col-md-3 col-xs-3 list"> <div class="list-group" id=""> <a class="list-group-item active" id="category-0" ng-click="getCategory()"> 全部 </a> <a class="list-group-item" ng-click="getCategory(category)" id="category-{{category.id}}" ng-repeat="category in categories">{{category.name}}</a> </div> </div> <div class="col-md-9 col-xs-9 grocery-merchandise-list list"> <div class="row nomargin merchandise riched-item" ng-repeat="merchandise in merchandises" ng-show="listed"> <div class="col-md-12 col-xs-12 color" ng-class="{\'color-even\': $even, \'color-odd\': $odd}"> <div class="image"> <i class="fa fa-image" aria-hidden="true" ng-show="!merchandise.images || !merchandise.images.length"></i> <img ng-src="{{image.url}}" alt="{{merchandise.name}}" ng-repeat="image in merchandise.images | limitTo: 1"> </div> <div class="caption"> <div class="counter merchandise-counter"></div> <p class="merchandise">{{merchandise.merchandise.name}}</p> <p class="sell">已经销售{{merchandise.number || 0}}件</p> <p class=""> <b>¥</b>&nbsp;<span>{{merchandise.price | currency}}</span> </p> </div> </div> </div> <div class="row nomargin no-merchandise" ng-show="listed && (!merchandises || merchandises.length < 1)"> <div class="alert text-center"> <p> <i class="fa fa-leaf not-found middle-icon"></i> </p> <p class="note middle-font"> 分类商品未找到！ </p> </div> </div> <div class="row nomargin no-merchandise loading" ng-show="!listed && fetched"> <div class="jumbotron"> <div class="container"> <div class="progress"> <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div> </div> <div class="alert alert-warning" role="alert"> 正在加载商品信息... </div> </div> </div> </div> </div> </div> <div ng-show="profiled" class="grocery-profile"> <ul class="list pad"> <li class="list-text-item"> <span>门店名称</span>{{grocery.name}}</li> <li class="list-text-item"> <span>门店Logo</span><img src="{{grocery.logo}}" class="logo image-uploader"></li> <li class="list-text-item"> <span>地址</span>{{grocery.address}}</li> <li class="list-text-item"> <span>联系电话</span>{{grocery.phone}}</li> <li class="list-text-item"> <span>营业时间</span>{{grocery.start_time}} - {{grocery.end_time}} </li> <li class="list-text-item"> <span>配送支持</span>{{grocery.delivery ? \'是\' : \'否\'}}</li> <li class="list-text-item" ng-show="grocery.delivery"> <span>配送范围</span>{{grocery.delivery_distance.toFixed(2)}} </li> <li class="list-text-item" ng-show="grocery.delivery"> <span>配送费用</span>{{grocery.delivery_fee | currency}} </li> <li class="list-text-item" ng-show="grocery.delivery"> <span>起送价</span>{{grocery.delivery_limit | currency}} </li> </ul> </div> <div ng-show="comments" class="grocery-comments"> <div class="alert text-center"> <p> <i class="fa fa-comments not-found big-icon"></i> </p> <p class="note big-font"> 暂无评论！ </p> </div> </div> </div> <grocery-cart ng-show="fetched && infoList"></grocery-cart> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/search/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/grocery/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> 搜索 </div> <div class="col-md-3 col-xs-3"> <!--<i class="fa fa-refresh" ng-click="reload()"></i>--> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row menu"> <div class="col-md-4 col-xs-4"> <a class="native-item settings" ng-href="#/search/merchandise"> <i class="fa fa-tags"></i> <span>商品搜索</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item position" ng-href="#/search/category"> <i class="fa fa-reorder"></i> <span>分类搜索</span> </a> </div> <div class="col-md-4 col-xs-4"> <a class="native-item preview" ng-href="#/search/order"> <i class="fa fa-file-text"></i> <span>订单搜索</span> </a> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/search/type.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a ng-href="#/search/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> 搜索{{type}} </div> <div class="col-md-3 col-xs-3"> <!--<i class="fa fa-refresh" ng-click="reload()"></i>--> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-xs-12"> <form class="form-horizontal password"> <div class="form-group"> <label for="old_passowrd" class="col-sm-2 control-label"></label> <div class="col-sm-10"> <input type="text" ng-model="q" ng-change="onChange()" class="form-control" id="q" placeholder="请输入{{type}}信息" name="q" required autofocus> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"></label> <div class="col-sm-10"> <input type="button" class="btn btn-danger btn-block" ng-click="search()" value="搜索"> </div> </div> </form> </div> </div> </div> <div class="jumbotron" ng-show="searching"> <div class="container"> <div class="alert alert-warning" role="alert"> <div class="progress" style="margin: 0px"> <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"> <span class="">正在加载...</span> </div> </div> </div> </div> </div> <!-- category --> <div ng-show="categories.length && !searching"> <div class="merchandise-list margin-top"> <div class="list list-bar" ng-repeat="category in categories track by $index"> <div class="list-text-item"><span>ID:</span>{{category.id}}</div> <div class="list-text-item"><span>分类名:</span>{{category.name || ""}}</div> <div class="list-text-item"><span>排序号:</span>{{category.order || ""}}</div> <div class="list-text-item"> <button class="btn btn-warning" ng-show="!category.online" ng-click="online(category);$event.stopPropagation()">上线 </button> <button class="btn btn-success" ng-show="category.online" ng-click="offline(category);$event.stopPropagation()">下线 </button> <a class="btn btn-info" href="#/category/edit/{{category.id}}">修改 </a> <button class="btn btn-danger" ng-click="remove(category);$event.stopPropagation()">删除</button> </div> </div> </div> </div> <!-- merchandise --> <div ng-show="merchandises.length && !searching"> <div class="row nomargin list list-item" ng-repeat-start="sm in merchandises track by $index"> <div class="col-xs-3 clear-text"> <img ng-repeat="image in sm.images" ng-src="{{image.url}}" alt="{{image.hash}}" class="image-uploader"> </div> <div class="col-xs-6 clear-text"> {{sm.merchandise.name || \'&nbsp;\'}} </div> <div class="col-xs-3 clear-text"> <div class="pointer vertical-center"> <i class="fa fa-chevron-down" id="show-item-{{sm.id}}" ng-click="showItem(sm.id)"></i> <i class="fa fa-chevron-up hidden" id="hide-item-{{sm.id}}" ng-click="hideItem(sm.id)"></i> </div> </div> </div> <div class="list list-bar hidden" ng-repeat-end id="list-{{sm.id}}"> <div class="list-text-item"><span>ID:</span>{{sm.id}}</div> <div class="list-text-item"><span>商品名:</span>{{sm.merchandise.name || \'&nbsp;\'}}</div> <div class="list-text-item"><span>品牌:</span>{{sm.merchandise.brand || \'&nbsp;\'}}</div> <div class="list-text-item"><span>价格:</span>{{sm.price | currency}}</div> <div class="list-text-item"><span>商品描述:</span><br>{{sm.merchandise.desc || \'&nbsp;\'}}</div> <div class="list-text-item"><span>分类:</span>{{sm.category.name || \'&nbsp;\'}}</div> <div class="list-text-item"><span>图片:</span><img ng-repeat="image in sm.images" ng-src="{{image.url}}" alt="{{image.hash}}" class="image-uploader"></div> <div class="list-text-item"> <button class="btn btn-warning" ng-show="!sm.online" ng-click="online(sm);$event.stopPropagation()">上线 </button> <button class="btn btn-success" ng-show="sm.online" ng-click="offline(sm);$event.stopPropagation()">下线 </button> <a class="btn btn-info" href="#/merchandise/edit/{{sm.id}}">修改 </a> <button class="btn btn-danger" ng-click="remove(sm);$event.stopPropagation()">删除</button> </div> </div> </div> <!-- order --> <div ng-show="orders.length && !searching"> <div class="list list-bar" ng-repeat="order in orders track by $index"> <!-- Default panel contents --> <div class="list-text-item"><span>订单ID:</span>{{order.id}} </div> <div class="list-text-item"><span>订单状态：</span> &nbsp; <button class="btn btn-warning disable btn-xs" disabled ng-show="showState(order, \'CREATED\')">已创建 </button> <button class="btn btn-warning disable btn-xs" disabled ng-show="showState(order, \'CANCELLED\')">已取消 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'ACCEPTED\')">已接单 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'PAID\')">已支付 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'DELIVERED\')">已经发货 </button> <button class="btn btn-danger disable btn-xs" disabled ng-show="showState(order, \'UNREACHABLE\')">无法送达 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'RECEIVED\')">已收货 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'COMMENTED\')">已评价 </button> <button class="btn btn-default disable btn-xs" disabled ng-show="showState(order, \'FINISHED\')">已完成 </button> </div> <div class="list-text-item"><span>操作：</span>&nbsp; <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'ACCEPTED\')" ng-click="state(order.id, \'ACCEPTED\')">接单 </button> <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'DELIVERED\')" ng-click="state(order.id, \'DELIVERED\')">发货 </button> <button class="btn btn-success btn-xs" ng-show="showTransState(order, \'FINISHED\')" ng-click="state(order.id, \'FINISHED\')">完成 </button> <button class="btn btn-danger btn-xs" ng-show="showTransState(order, \'CANCELLED\')" ng-click="state(order.id, \'CANCELLED\')">取消 </button> </div> <div class="list-text-item"><span>更多内容</span> <a id="order-detail-show-{{order.no}}" class="btn btn-xs" ng-click="showDetail(order)"><i class="fa fa-caret-down"></i> 详情</a><a id="order-detail-hide-{{order.no}}" class="btn btn-xs hidden" ng-click="hideDetail(order)"><i class="fa fa-caret-up"></i> 隐藏</a></div> <div class="hidden" id="order-detail-{{order.no}}"> <div class="list-text-item"><span>订单号：</span>{{order.no}}</div> <div class="list-text-item"><span>帐户：</span> <a target="user-info" href="#/user/info/{{order.user.id}}">{{order.user.username || \' \'}}</a></div> <div class="list-text-item"><span>下单时间：</span>{{order.createdAt | date}}</div> <div class="list-text-item"><span>接收人：</span>{{order.receiver || "&nbsp;"}}</div> <div class="list-text-item"><span>联系电话：</span>{{order.phone || "&nbsp;"}}</div> <div class="list-text-item"><span>支付方式：</span>{{order.payment | payment}}</div> <div class="list-text-item"><span>配送方式：</span>{{order.delivery | delivery}}</div> <div class="list-text-item"><span>送货地址：</span>{{order.address || "&nbsp;"}}</div> <div class="list-text-item"><span>总数量：</span>{{order.total || "&nbsp;"}}</div> <div class="list-text-item"><span>总价格：</span>{{order.summary | currency}}</div> <div class="inner-list" ng-repeat="merchandise in order.merchandises"> <div class="list-text-item"> <span>商品名：</span>{{merchandise.name || "&nbsp;"}} </div> <div class="list-text-item"> <span>图片：</span> <a ng-href="{{merchandise.url}}" target="merchandise"> <img style="width:40px;height:40px" ng-src="{{merchandise.url}}" alt="{{merchandise.name}}"></a> </div> <div class="list-text-item"> <span>品牌</span> {{merchandise.brand || "&nbsp;"}} </div> <div class="list-text-item"> <span>数量</span> {{merchandise.number || "&nbsp;"}} </div> <div class="list-text-item"> <span>单价</span> ¥ {{merchandise.price | currency}} </div> <div class="list-text-item"> <span>优惠价</span> {{merchandise.discount || "&nbsp;"}} </div> </div> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/about.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/user/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6">关于</div> <div class="col-md-3 col-xs-3"> </div> </div> </div> </div> <div class="body-bar"> <div class="about"> <h2>田一块小卖部</h2> <h3>你手上的小卖部</h3> <p> <img src="images/logo.png" alt="logo" width="50px" height="50px"> </p> <h3>扫描或者长按二维码关注</h3> <p> <img src="images/tykqrcode.png" alt="logo" width="150px" height="150px"> </p> <h4>北京田一块网络科技有限公司</h4> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/feedback.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/grocery/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> 意见反馈 </div> <div class="col-md-3 col-xs-3"> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-xs-12"> <form class="feedback"> <div class="form-group"> <label for="feedback">请输入您的意见或建议</label> <textarea name="feedback" class="form-control" id="feedback"></textarea> </div> <div class="form-group"> <button type="button" class="btn btn-danger btn-block" ng-click="feedback()">提交</button> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/home.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"></div> <div class="col-md-6 col-xs-6"> 店长信息 </div> <div class="col-md-3 col-xs-3"></div> </div> </div> </div> <div class="body-bar"> <div class="user"> <div class="list margin-top"> <a class="profile" href="#/user/profile"> <div class="logo"><img ng-src="{{user.extra.avatar.url || \'images/logo.png\'}}" class="image-uploader"></div> <div class="content"> <h1> {{user.extra.nickname || "昵称未指定"}} </h1> <h2> {{user.username || "&nbsp;"}} </h2> </div> </a> </div> <div class="list margin-top"> <a class="list-select-item" href="#/user/password"> <i class="fa fa-key list-item-style icon-password"></i> 密码修改 </a> </div> <div class="list margin-top"> <a class="list-select-item" href="#/user/about"> <i class="fa fa-question-circle list-item-style icon-about"></i> 关于 </a> <a class="list-select-item" href="#/user/feedback"> <i class="fa fa-commenting list-item-style icon-feedback"></i> 意见反馈 </a> </div> <div class="list margin-top"> <a class="list-select-item" href="http://m.t1bao.com/"> <i class="fa fa-external-link-square list-item-style icon-link"></i> 查看消费者端 </a> </div> <div class="list margin-top"> <a class="list-select-item-no-arrow" ng-click="logout()"> <i class="fa fa-sign-out list-item-style icon-logout"></i> 退出 </a> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),
a.put("views/user/login.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"></div> <div class="col-md-6 col-xs-8">店长登录</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="form-horizontal"> <div class="form-group"> <label for="username" class="col-sm-2 control-label">账号</label> <div class="col-sm-10"> <input type="text" class="form-control" id="username" placeholder="账号" name="username" ng-model="username" required autofocus> </div> </div> <div class="form-group"> <label for="password" class="col-sm-2 control-label">密码</label> <div class="col-sm-10"> <input type="password" id="password" class="form-control" name="password" placeholder="密码" ng-model="password" required> </div> </div> <div class="form-group"> <label for="password" class="col-sm-1 control-label"></label> <div class="col-sm-11"> <button class="btn btn-danger btn-block" type="submit" ng-click="login()">登录</button> </div> <label for="password" class="col-sm-4 control-label"></label> </div> <hr> <p class="alert-default" role="alert"> 没有账号?马上 <a class="btn btn-warning" href="#/user/register">注册</a> </p> <p class="alert-primary text-right" role="alert"> 忘记密码？马上 <a class="btn btn-default" href="#/user/password/retrieve">找回</a> </p> </form> <!-- <p class="alert alert-info visible-xs-block" role="alert">提示：在PC或者平板上进行操作可能会更方便</p> --> </div> </div> </div> </div> <!-- /container --> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/password.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-3"> <a href="#/user/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-6"> 密码修改 </div> <div class="col-md-3 col-xs-3"> </div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-xs-12"> <form class="form-horizontal password"> <div class="form-group"> <label for="old_passowrd" class="col-sm-2 control-label">原密码</label> <div class="col-sm-10"> <input type="password" class="form-control" id="old_passowrd" placeholder="输入原密码" name="old" required autofocus> </div> </div> <div class="form-group"> <label for="new_passowrd" class="col-sm-2 control-label">新密码</label> <div class="col-sm-10"> <input type="password" class="form-control" id="new_passowrd" placeholder="输入新密码" name="new" required autofocus> </div> </div> <div class="form-group"> <label for="confirm" class="col-sm-2 control-label">确认密码</label> <div class="col-sm-10"> <input type="password" class="form-control" id="confirm" placeholder="输入确认密码" name="confirm" required autofocus> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"></label> <div class="col-sm-10"> <input type="button" class="btn btn-danger btn-block" ng-click="updatePassword()" value="更新"> </div> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/profile.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"> <a href="#/user/home"> <i class="fa fa-arrow-left"></i> </a> </div> <div class="col-md-6 col-xs-8">我的信息</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-xs-12"> <form class="user-profile modify"> <div class="form-group"> <label for="nickname" class="control-label">昵称</label> <input type="text" class="form-control" name="nickname" id="nickname" placeholder="" value="{{user.extra.nickname}}"> </div> <div class="form-group"> <label for="phone" class="control-label">电话</label> <!-- <input type="text" class="form-control" name="phone" id="phone" placeholder="" value="{{user.phone}}"> --> <p class="form-control-static">{{user.phone}}</p> </div> <div class="form-group"> <label for="email" class="control-label">邮箱</label> <!-- <input type="text" class="form-control" name="email" id="email" placeholder="" value="{{user.email}}"> --> <p class="form-control-static">{{user.email}}</p> </div> <div class="form-group"> <label for="intro" class="control-label">介绍</label> <textarea class="form-control" name="intro" id="intro" placeholder="">{{user.extra.intro}}</textarea> </div> <div class="form-group"> <label for="logo" class="control-label">头像</label> <img ng-src="{{user.extra.avatar.url || \'\'}}" name="image-logo" class="image-uploader"> <!-- <span class="cross"><i class="fa fa-plus"></i></span> --> <div class="image-uploader"> <input type="file" id="logo" class="image-uploader" name="avatar" onchange="angular.element(this).scope().fileChanged()"> </div> </div> <div class="form-group"> <button type="button" class="btn btn-danger btn-block" ng-click="modify()">保存</button> </div> </form> </div> </div> </div> </div> <div ng-include src="\'views/footer.html\'"></div>'),a.put("views/user/register.html",'<div class="header-bar"> <div class="container"> <div class="row"> <div class="col-md-3 col-xs-2"></div> <div class="col-md-6 col-xs-8">店长注册</div> <div class="col-md-3 col-xs-2"></div> </div> </div> </div> <div class="body-bar"> <div class="container"> <div class="row"> <div class="col-md-12 col-xs-12 col-lg-12"> <form class="user-register"> <div class="form-group" ng-show="!checked"> <label for="image-captcha">图片验证码：</label> <p id="image-captcha"><span data="{{url}}captcha/image" ng-click="updateImage()"><img src="{{url}}captcha/image"> </span> <i class="fa fa-check-circle" ng-show="captcha && checked"></i> <i class="fa fa-times-circle" ng-show="captcha && !checked"> 验证码错误</i> <button class="btn btn-warning btn-xs" ng-click="updateImage()">刷新</button> </p> </div> <div class="form-group" ng-show="!checked"> <label>输入图片验证码：</label> <input name="captchaImage" type="text" class="form-control" placeholder="验证码"> <br> <p class="text-info">验证码正确后，注册流程会自动开启</p> </div> <div class="form-group" ng-show="checked"> <label for="phone">请输入手机号</label> <input name="phone" id="phone" type="phone" class="form-control" ng-model="phone" placeholder="手机号"> </div> <div class="form-group" ng-show="checked"> <label>输入短信验证码：</label> <input name="captchaSms" type="text" class="form-control" placeholder="验证码" ng-model="captchaString"> </div> <div class="form-group" ng-show="checked && !fetching"> <label> <a class="btn btn-color-egg-blue btn-get-sms-captcha" ng-click="getCaptcha()">获取验证码</a> </label> </div> <p class="center"><a class="btn btn-success btn-block btn-register" ng-class="{disabled: !checked}" ng-click="phoneRegister()">注册</a></p> <hr> <p class="alert-primary visible-xs-block text-left" role="alert"> 已有账号? 马上 <a class="btn btn-danger" href="#/user/login">登录</a> </p> <p class="alert-primary visible-xs-block text-right" role="alert"> 忘记密码？马上 <a class="btn btn-default" href="#/user/password/retrieve">找回</a> </p> </form> </div> </div> </div> </div> <!-- /container --> <div ng-include src="\'views/modal.html\'"></div> <div ng-include src="\'views/footer.html\'"></div>')}]);